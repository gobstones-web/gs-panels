<link rel="import" href="gs-panel-simple.html">
<link rel="import" href="gs-panel-resize.html">
<link rel="import" href="gs-rezisable.html">
<link rel="import" href="../../../gs-common/dist/components/dom-inject.html">
<dom-module id="gs-panel-composite">
  <template>
    <style>
      :host {
        background-color: #BBF;
        display: flex;
        flex: 1;
      }
      :host .vertical {
        flex-direction: column;
      }
      :host > #container {
        display: flex;
        flex: 1;
      }

    </style>

    <template is="dom-repeat" items="{{children}}" as="child" index-as="itemIndex">
      <template is="dom-inject" element="{{child}}"></template>
    </template>
    <template is="dom-if" if="{{notLast}}">
      <gs-panel-resize class$="{{parentOrientation}}"></gs-panel-resize>
    </template>
  </template>
  <script>
    Polymer({
      is: 'gs-panel-composite',
      properties: {
        children: {
          type: Array
        },
        panelHeight: {
          type: Number,
          value: 0
        },
        orientation: {
          type: String
        }
      },
      behaviors: [GS.Rezisable],
      observers: ['_update(children.*, panelHeight)'],
      ready: function() {
        this.children = [];
        this.orientation = this.orientation || GS.HORIZONTAL;
        this.classList.add(this.orientation);
        return this.classList.add('child-of-' + this.parentOrientation);
      },
      _update: function() {
        var child, index, last_index, _i, _len, _ref, _results;
        if (this.children.length > 0) {
          this.style.height = this.panelHeight + 'px';
        } else {
          this.style.height = 'none';
        }
        last_index = this.children.length - 1;
        _ref = this.children;
        _results = [];
        for (index = _i = 0, _len = _ref.length; _i < _len; index = ++_i) {
          child = _ref[index];
          child.panelHeight = this.panelHeight;
          _results.push(child.notLast = index !== last_index);
        }
        return _results;
      },
      add: function(element) {
        var next;
        next = document.createElement('gs-panel-simple');
        next.concretElement = element;
        next.parentOrientation = this.orientation;
        this.__after_push(next, 0);
        return this.push('children', next);
      }
    });

  </script>
</dom-module>